{% extends 'base.html' %}
{% load static %}
{% block csslib %}
{% endblock %}
{% block title %}Página Inicial | OBD - Organização Brasileira de Dardos{% endblock %}
{% block styles %}
{% endblock %}
{% block content %}

<div class="container-fluid fade-in">
    <div class="row">
        <!-- Left Sidebar (Sticky) -->
        <div class="col-lg-1 d-none d-lg-block">
            <div class="sticky-top" style="top: 80px;">
                <!-- Future sponsor logo space -->
            </div>
        </div>

        <!-- Main Content -->
        <div class="col-lg-10">

            <!-- Hero Banner -->
            <div class="mb-2 d-flex justify-content-center">
                <img src="{% static 'core/media/logos/new_banner_obd.png' %}" class="img-fluid rounded shadow-lg w-100"
                    alt="OBD Banner">
            </div>

            <!-- Welcome Card -->
            <div class="card card-dartboard text-center mb-4">
                <div class="card-header card-header-dartboard">
                    <i class="bi bi-bullseye"></i> Bem-vindo ao Portal OBD
                </div>
                <div class="card-body py-3">
                    <h2 class="card-title mb-3 fw-bold">Organização Brasileira de Dardos</h2>
                    <p class="card-text lead text-muted mb-4">Bem-vindo ao universo dos dardos no Brasil. Venha se
                        divertir conosco!</p>
                    <div class="d-flex justify-content-center gap-3 flex-wrap">
                        {% if not user.is_authenticated %}
                        <a href="{% url 'players:login' %}" class="btn btn-dartboard-secondary btn-lg"><i
                                class="bi bi-box-arrow-in-right"></i> Login</a>
                        <a href="/subscribe/" class="btn btn-dartboard-primary btn-lg"><i
                                class="bi bi-pencil-square"></i>
                            Cadastrar-se</a>
                        {% endif %}
                        <a href="#obd-stats" class="btn btn-dartboard-outline btn-lg"><i class="bi bi-graph-up"></i> Ver
                            Estatísticas</a>
                    </div>
                </div>
                <div class="card-footer card-footer-dartboard text-muted small">
                    <div class="d-flex justify-content-between align-items-center flex-wrap">
                        <span>Versão 2.0 | Status: <span class="text-dartboard-green fw-bold">Online</span> <span
                                class="spinner-grow spinner-grow-sm text-success" role="status"></span></span>
                    </div>
                </div>
            </div>

            <!-- Content Grid -->
            <div class="row g-4 mb-5" id="obd-news">
                <!-- Recent Games -->
                <div class="col-lg-8">
                    <div class="card card-dartboard h-100">
                        <div class="card-header card-header-dartboard green">
                            <i class="bi bi-clock-history"></i> Informes OBD
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <!-- News Column -->
                                <div class="col-md-6 mb-3 mb-md-0">
                                    <h5 class="card-title fw-bold mb-3"><i
                                            class="bi bi-newspaper text-dartboard-green"></i> Notícias</h5>
                                    {% if news %}<div class="list-group list-group-flush">
                                        {% for item in news %}
                                        <a href="{{ item.link }}"
                                            class="list-group-item list-group-item-action flex-column align-items-start"
                                            target="_blank">
                                            <div class="d-flex w-100 justify-content-between">
                                                <h6 class="mb-1 fw-bold">{{ item.title }}</h6>
                                                <small class="text-muted">{{ item.published_date|date:'d/m/Y' }}</small>
                                            </div>
                                            <p class="mb-1 small text-muted">{{ item.summary|truncatechars:60 }}</p>
                                        </a>
                                        {% endfor %}
                                    </div>
                                    <div class="mt-3 text-center">
                                        <a href="{% url 'news' %}" class="btn btn-sm btn-outline-secondary">Ver
                                            todas</a>
                                    </div>
                                    {% else %}
                                    <p class="text-muted text-center my-4">Nenhuma notícia recente.</p>
                                    {% endif %}
                                </div>


                                <!-- Documents Column -->
                                <div class="col-md-6">
                                    <h5 class="card-title fw-bold mb-3"><i
                                            class="bi bi-file-earmark-text text-dartboard-red"></i> Documentos</h5>
                                    {% if documents %}<div class="list-group list-group-flush">
                                        {% for doc in documents %}
                                        <div class="list-group-item d-flex justify-content-between align-items-center">
                                            <div>
                                                <h6 class="mb-0">{{ doc.title }}</h6>
                                                <small class="text-muted">
                                                    {{ doc.get_category_display }} • {{ doc.publish_date|date:'d/m/Y' }}
                                                </small>
                                            </div>
                                            <a href="{{ doc.file.url }}" class="btn btn-sm btn-dartboard-outline"
                                                target="_blank" download>
                                                <i class="bi bi-download"></i>
                                            </a>
                                        </div>
                                        {% endfor %}
                                    </div>
                                    <div class="mt-3 text-center">
                                        <a href="{% url 'documents' %}" class="btn btn-sm btn-outline-secondary">Ver
                                            todos</a>
                                    </div>
                                    {% else %}
                                    <p class="text-muted text-center my-4">Nenhum documento disponível.</p>
                                    {% endif %}
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sponsors Carousel -->
                <div class="col-lg-4">
                    <div class="card card-dartboard h-100">
                        <div class="card-header card-header-dartboard gold">
                            <i class="bi bi-star"></i> Apoiadores
                        </div>
                        <div class="card-body p-0 d-flex align-items-center bg-white rounded-bottom">
                            <div id="sponsorsCarousel" class="carousel slide w-100" data-bs-ride="carousel">
                                <div class="carousel-inner">
                                    <div class="carousel-item active">
                                        <img src="{% static 'img/sponsors/redstone_dartboards.jpg' %}"
                                            class="d-block w-100" style="height: 300px; object-fit: contain;"
                                            alt="RedStone Prescott Dartboards">
                                    </div>
                                    <div class="carousel-item">
                                        <a href="https://ongclubeup.org/" target="_blank">
                                            <img src="{% static 'img/sponsors/clube_up.png' %}" class="d-block w-100"
                                                style="height: 300px; object-fit: contain;" alt="Clube Up">
                                        </a>
                                    </div>
                                    <div class="carousel-item">
                                        <a href="https://www.petraagregados.com/" target="_blank">
                                            <img src="{% static 'img/sponsors/petra.png' %}" class="d-block w-100"
                                                style="height: 300px; object-fit: contain;" alt="Petra">
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Player Stats -->
            <div class="mb-5">
                <h3 class="text-center mb-4 fw-bold"><i class="bi bi-person-lines-fill text-dartboard-red"></i>
                    Estatísticas
                    dos Jogadores</h3>
                <div class="row g-4">
                    <!-- Best Averages -->
                    <div class="col-md-4">
                        <div class="card card-dartboard h-100">
                            <div
                                class="card-header card-header-dartboard d-flex justify-content-between align-items-center">
                                <span>Melhores Médias</span> <i class="bi bi-award"></i>
                            </div>
                            <ul class="list-group list-group-flush">
                                {% for line in stats_avg %}
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    {% if line.user.profile.pin and line.user.first_name and line.user.last_name %}
                                    <a
                                        href="{% url 'profiles:publicprofile' pin=line.user.profile.pin first=line.user.first_name last=line.user.last_name %}">
                                        <span class="fw-bold text-muted me-2">{{ forloop.counter }}º</span>
                                        {{ line.user.first_name }} {{ line.user.last_name }}
                                    </a>
                                    {% else %}
                                    <span>
                                        <span class="fw-bold text-muted me-2">{{ forloop.counter }}º</span>
                                        {{ line.user.first_name }} {{ line.user.last_name }}
                                    </span>
                                    {% endif %}
                                    <span class="badge badge-dartboard badge-red rounded-pill">
                                        {{ line.bcmAvg | floatformat:"2" }}
                                    </span>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div> <!-- Best Checkouts -->
                    <div class="col-md-4">
                        <div class="card card-dartboard h-100">
                            <div
                                class="card-header card-header-dartboard green d-flex justify-content-between align-items-center">
                                <span>Melhores Fechadas</span> <i class="bi bi-calculator"></i>
                            </div>
                            <ul class="list-group list-group-flush">
                                {% for line in stats_out %}
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    {% if line.user.profile.pin and line.user.first_name and line.user.last_name %}
                                    <a
                                        href="{% url 'profiles:publicprofile' pin=line.user.profile.pin first=line.user.first_name last=line.user.last_name %}">
                                        <span class="fw-bold text-muted me-2">{{ forloop.counter }}º</span>
                                        {{ line.user.first_name }} {{ line.user.last_name }}
                                    </a>
                                    {% else %}
                                    <span>
                                        <span class="fw-bold text-muted me-2">{{ forloop.counter }}º</span>
                                        {{ line.user.first_name }} {{ line.user.last_name }}
                                    </span>
                                    {% endif %}
                                    <span class="badge badge-dartboard badge-green rounded-pill">
                                        {{ line.bcmOut }}
                                    </span>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>

                    <!-- Top 180s -->
                    <div class="col-md-4">
                        <div class="card card-dartboard h-100">
                            <div
                                class="card-header card-header-dartboard d-flex justify-content-between align-items-center">
                                <span>Top 180s</span> <i class="bi bi-lightning-charge-fill"></i>
                            </div>
                            <ul class="list-group list-group-flush">
                                {% for line in stats_180 %}
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    {% if line.user.profile.pin and line.user.first_name and line.user.last_name %}
                                    <a
                                        href="{% url 'profiles:publicprofile' pin=line.user.profile.pin first=line.user.first_name last=line.user.last_name %}">
                                        <span class="fw-bold text-muted me-2">{{ forloop.counter }}º</span>
                                        {{ line.user.first_name }} {{ line.user.last_name }}
                                    </a>
                                    {% else %}
                                    <span>
                                        <span class="fw-bold text-muted me-2">{{ forloop.counter }}º</span>
                                        {{ line.user.first_name }} {{ line.user.last_name }}
                                    </span>
                                    {% endif %}
                                    <span class="badge badge-dartboard badge-gold rounded-pill">
                                        {{ line.bcmTon80 }}
                                    </span>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- OBD Stats -->
            <div class="mb-5" id="obd-stats">
                <div class="d-flex justify-content-center mb-3">
                    <form method="GET" action="{% url 'index' %}" class="d-inline-group w-100"
                        style="max-width: 300px;">
                        <select name="tournament_id" class="form-select bg-dark text-white border-secondary"
                            onchange="sessionStorage.setItem('scrollPosition', window.scrollY); this.form.submit()"
                            style="background-image: url('data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 16 16\'%3e%3cpath fill=\'none\' stroke=\'%23ffffff\' stroke-linecap=\'round\' stroke-linejoin=\'round\' stroke-width=\'2\' d=\'M2 5l6 6 6-6\'/%3e%3c/svg%3e');">
                            {% for t in all_tournaments %}
                            <option value="{{ t.id }}" {% if t.id == selected_tournament_id %}selected{% endif %}>
                                {{ t.name }} ({{ t.date|date:"d/m/Y" }})
                            </option>
                            {% endfor %}
                        </select>
                    </form>
                </div>
                <h3 class="text-center mb-4 fw-bold">
                    <i class="bi bi-graph-up text-accent"></i> Estatísticas OBD
                    {% if tournament_stats %}
                    <small class="text-muted fs-6">({{ tournament_stats.name }})</small>
                    {% endif %}
                </h3>
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-header bg-secondary text-white">Dados Gerais</div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Média Geral
                                    <span class="badge bg-primary rounded-pill">
                                        {% if tournament_stats %}
                                        {{ tournament_stats.average|floatformat:"2" }}
                                        {% else %}
                                        {% if boa.average %}
                                        {{ boa.average|floatformat:"2" }}
                                        {% else %}
                                        0
                                        {% endif %}
                                        {% endif %}
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Partidas
                                    <span class="badge bg-primary rounded-pill">
                                        {% if tournament_stats %}
                                        {{ tournament_stats.matches }}
                                        {% else %}
                                        {{ games|default:"0" }}
                                        {% endif %}
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Legs
                                    <span class="badge bg-primary rounded-pill">
                                        {% if tournament_stats %}
                                        {{ tournament_stats.legs }}
                                        {% else %}
                                        {{ boa.legs|default:"0" }}
                                        {% endif %}
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Jogadores
                                    <span class="badge bg-primary rounded-pill">
                                        {% if tournament_stats %}
                                        {{ tournament_stats.players }}
                                        {% else %}
                                        {{ members|default:"0" }}
                                        {% endif %}
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-header bg-secondary text-white">Scores</div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    100+
                                    <span class="badge bg-primary rounded-pill">
                                        {% if tournament_stats %}
                                        {{ tournament_stats.ton }}
                                        {% else %}
                                        {{ boa.ton|default:"0" }}
                                        {% endif %}
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    140+
                                    <span class="badge bg-primary rounded-pill">
                                        {% if tournament_stats %}
                                        {{ tournament_stats.ton40 }}
                                        {% else %}
                                        {{ boa.ton40|default:"0" }}
                                        {% endif %}
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    170+
                                    <span class="badge bg-primary rounded-pill">
                                        {% if tournament_stats %}
                                        {{ tournament_stats.ton70 }}
                                        {% else %}
                                        {{ boa.ton70|default:"0" }}
                                        {% endif %}
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    180s
                                    <span class="badge bg-danger rounded-pill">
                                        {% if tournament_stats %}
                                        {{ tournament_stats.ton80 }}
                                        {% else %}
                                        {{ boa.ton80|default:"0" }}
                                        {% endif %}
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card h-100">
                            {% with ts=tournament_stats %}
                            {% if ts %}<div class="card-header bg-secondary text-white">Recordes</div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Maior Fechamento
                                    <span class="badge bg-primary rounded-pill">{{ ts.highest_out }}</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Melhor Leg (Dardos)
                                    <span class="badge bg-primary rounded-pill">{{ ts.best_leg }}</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Melhor Média
                                    <span class="badge bg-primary rounded-pill">{{ ts.best_avg|floatformat:"2" }}</span>
                                </li>
                            </ul>
                            {% else %}
                            <div class="card-header bg-secondary text-white">Servidores</div>
                            <ul class="list-group list-group-flush">

                                <li class="list-group-item d-flex justify-content-between align-items-center">Nakka
                                    <span class="badge bg-primary rounded-pill">{{ server.nakka }}</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">Manual
                                    <span class="badge bg-primary rounded-pill">{{ server.manual }}</span>
                                </li>
                            </ul>
                            {% endif %}
                            {% endwith %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tournament Champion Highlight -->
            {% if tournament_stats.champion_name %}
            {% with ts=tournament_stats %}
            <div class="mb-5">
                <div class="card card-dartboard border-warning shadow-lg">
                    <div class="card-header card-header-dartboard gold text-center py-3">
                        <h4 class="mb-0"><i class="bi bi-trophy-fill text-warning"></i> Campeão do Campeonato Brasileiro
                            de Dardos OBD 2025</h4>
                    </div>
                    <div class="card-body text-center py-5 bg-gradient">
                        <h1 class="display-3 fw-bold text-dartboard-gold mb-4">
                            {{ ts.champion_name|upper }}
                        </h1>
                        <div class="row justify-content-center">
                            <div class="col-md-3">
                                <div class="p-3">
                                    <i class="bi bi-graph-up fs-2 text-dartboard-red"></i>
                                    <h5 class="mt-2 mb-1 text-muted">Média</h5>
                                    <h3 class="fw-bold">{{ ts.champion_avg|floatformat:"2" }}</h3>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="p-3">
                                    <i class="bi bi-trophy fs-2 text-dartboard-green"></i>
                                    <h5 class="mt-2 mb-1 text-muted">Partidas Vencidas</h5>
                                    <h3 class="fw-bold">{{ ts.champion_matches_won }}</h3>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="p-3">
                                    <i class="bi bi-check-circle fs-2 text-dartboard-gold"></i>
                                    <h5 class="mt-2 mb-1 text-muted">Legs Vencidos</h5>
                                    <h3 class="fw-bold">{{ ts.champion_legs_won }}</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endwith %}
            {% endif %}

            <!-- Tournament Standings -->
            {% if tournament_standings %}
            <div class="mb-5" id="tournament-standings">
                <div class="d-flex justify-content-center align-items-center mb-4 flex-wrap gap-3">
                    <h3 class="mb-0 fw-bold"><i class="bi bi-trophy text-accent"></i> Classificação do Campeonato</h3>
                </div>
                <div class="table-responsive">
                    <table
                        class="table table-dark table-striped table-hover text-center align-middle rounded overflow-hidden">
                        <thead>
                            <tr>
                                <th>Pos</th>
                                <th>Jogador</th>
                                <th>Média</th>
                                <th>Partidas</th>
                                <th>Vitórias</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for player in tournament_standings %}
                            {% with avg=player.average_3_dart %}
                            <tr>
                                <th class="fs-5">{{ player.rank }}º</th>
                                <td class="fw-bold">{{ player.player_name }}</td>
                                <td><span class="badge bg-primary rounded-pill">{{ avg|floatformat:"2" }}</span></td>
                                <td>{{ player.matches_played }}</td>
                                <td>{{ player.matches_won }}</td>
                            </tr>
                            {% endwith %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            {% endif %}

            <!-- Videos -->
            <div class="row g-4 mb-5" id="obd-videos">
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-header bg-danger text-white"><i class="bi bi-youtube"></i> OBD TV</div>
                        <div class="card-body p-0">
                            <div class="ratio ratio-16x9">
                                <a href="https://www.youtube.com/@OBDardos" target="_blank">
                                    <img src="{% static '/media/logos/Logo_OBD_3.jpeg' %}" class="img-fluid"
                                        alt="OBD TV"
                                        style="object-fit: contain; width: 100%; height: 100%; background-color: #000;">
                                </a>
                            </div>
                        </div>
                        <div class="card-footer text-center">
                            <a href="https://www.youtube.com/@OBDardos" target="_blank"
                                class="btn btn-sm btn-danger">Inscrever-se</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card h-100">
                        <div class="card-header bg-danger text-white"><i class="bi bi-youtube"></i> Diogo Portela TV
                        </div>
                        <div class="card-body p-0">
                            <div class="ratio ratio-16x9">
                                <a href="https://www.youtube.com/channel/UC6spzS1PJkv9rw9UfyZTpGg" target="_blank">
                                    <img src="{% static '/media/logos/diogo_portela_tv.png' %}" class="img-fluid"
                                        alt="Diogo Portela TV"
                                        style="object-fit: contain; width: 100%; height: 100%; background-color: #000;">
                                </a>
                            </div>
                        </div>
                        <div class="card-footer text-center">
                            <a href="https://www.youtube.com/channel/UC6spzS1PJkv9rw9UfyZTpGg" target="_blank"
                                class="btn btn-sm btn-danger">Inscrever-se</a>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Right Sidebar (Sticky) - Sponsor -->
        <div class="col-lg-1 d-none d-lg-block">
            <div class="sticky-top" style="top: 50vh; transform: translateY(-50%);">
                <div class="card border-0 shadow-sm">
                    <img src="{% static 'img/sponsors/redstone_dartboards.jpg' %}" class="img-fluid rounded"
                        alt="RedStone Prescott Dartboards" style="width: 100%; height: auto;">
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Floating Sidebar Navigation -->
<div class="floating-nav-left d-none d-xl-block">
    <a href="#obd-stats" class="nav-float-btn" data-bs-toggle="tooltip" data-bs-placement="right"
        title="Estatísticas OBD">
        <i class="bi bi-graph-up"></i>
    </a>
    <a href="/obd/league/all/champions" class="nav-float-btn" data-bs-toggle="tooltip" data-bs-placement="right"
        title="Hall dos Campeões">
        <i class="bi bi-trophy"></i>
    </a>
    <a href="#obd-news" class="nav-float-btn" data-bs-toggle="tooltip" data-bs-placement="right" title="Notícias">
        <i class="bi bi-newspaper"></i>
    </a>
    <a href="#obd-videos" class="nav-float-btn" data-bs-toggle="tooltip" data-bs-placement="right" title="Vídeos">
        <i class="bi bi-play-circle"></i>
    </a>
    <a href="#top" class="nav-float-btn nav-top" data-bs-toggle="tooltip" data-bs-placement="right"
        title="Voltar ao Topo">
        <i class="bi bi-arrow-up-circle"></i>
    </a>
</div>

<style>
    /* Floating Navigation Sidebar */
    .floating-nav-left {
        position: fixed;
        left: 2%;
        top: 50%;
        transform: translateY(-50%);
        z-index: 1000;
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .nav-float-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
        color: #ffc107;
        border-radius: 50%;
        text-decoration: none;
        font-size: 1.3rem;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        border: 2px solid rgba(255, 193, 7, 0.3);
        backdrop-filter: blur(10px);
    }

    .nav-float-btn:hover {
        background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
        color: #000;
        transform: scale(1.15) translateX(5px);
        box-shadow: 0 6px 25px rgba(255, 193, 7, 0.5);
        border-color: #ffc107;
    }

    .nav-float-btn i {
        transition: transform 0.3s ease;
    }

    .nav-float-btn:hover i {
        transform: scale(1.1);
    }

    .nav-float-btn.nav-top {
        background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        border-color: rgba(220, 53, 69, 0.3);
    }

    .nav-float-btn.nav-top:hover {
        background: linear-gradient(135deg, #ff4757 0%, #dc3545 100%);
        border-color: #dc3545;
    }

    /* Smooth scroll behavior */
    html {
        scroll-behavior: smooth;
    }

    /* Animation on page load */
    @keyframes slideInLeft {
        from {
            opacity: 0;
            transform: translateX(-50px) translateY(-50%);
        }

        to {
            opacity: 1;
            transform: translateX(0) translateY(-50%);
        }
    }

    .floating-nav-left {
        animation: slideInLeft 0.8s ease-out;
    }

    /* Show only on larger screens */
    @media (max-width: 1199.98px) {
        .floating-nav-left {
            display: none !important;
        }
    }
</style>

<script>
    // Initialize tooltips for floating navigation
    document.addEventListener('DOMContentLoaded', function () {
        // Restore scroll position if set
        const scrollPosition = sessionStorage.getItem('scrollPosition');
        if (scrollPosition) {
            window.scrollTo(0, parseInt(scrollPosition));
            sessionStorage.removeItem('scrollPosition');
        }

        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });

        // Generic smooth scroll function with navbar offset
        function smoothScrollToTarget(targetSelector) {
            if (targetSelector === '#top' || targetSelector === '') {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            } else {
                const target = document.querySelector(targetSelector);
                if (target) {
                    // Get navbar height to offset scroll position
                    const navbar = document.querySelector('.navbar-dartboard');
                    const navbarHeight = navbar ? navbar.offsetHeight : 70;
                    const targetPosition = target.getBoundingClientRect().top + window.pageYOffset;
                    const offsetPosition = targetPosition - navbarHeight - 20; // 20px extra padding

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                }
            }
        }

        // Apply smooth scroll to ALL anchor links on the page
        document.querySelectorAll('a[href^="#"]').forEach(function (anchor) {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href');

                // Only handle internal anchors
                if (href && href.startsWith('#') && href !== '#') {
                    e.preventDefault();
                    smoothScrollToTarget(href);
                }
            });
        });
    });
</script>

{% endblock %}
{% block jslib %}
{% endblock %}
